
%% db4
lpd = [-0.010597401784997278, 0.032883011666982945, 0.030841381835986965,...
       -0.18703481171888114, -0.02798376941698385, 0.6308807679295904,...
        0.7148465705525415, 0.23037781330885523];
hpd = [-0.23037781330885523, 0.7148465705525415, -0.6308807679295904,...
       -0.02798376941698385, 0.18703481171888114, 0.030841381835986965,...
       -0.032883011666982945, -0.010597401784997278];

%% coiflets 2
%lpd = [-0.0007205494453645122, -0.0018232088707029932, 0.0056114348193944995,...
%        0.023680171946334084, -0.0594344186464569, -0.0764885990783064,...
%        0.41700518442169254, 0.8127236354455423, 0.3861100668211622,...
%       -0.06737255472196302, -0.04146493678175915, 0.016387336463522112];

%hpd = [-0.016387336463522112, -0.04146493678175915, 0.06737255472196302,...
%        0.3861100668211622, -0.8127236354455423, 0.41700518442169254,...
%        0.0764885990783064, -0.0594344186464569, -0.023680171946334084,...
%        0.0056114348193944995, 0.0018232088707029932, -0.0007205494453645122];

%lpd = [0.7071067811865476 0.7071067811865476];
%hpd = [-0.7071067811865476 0.7071067811865476] ;




dat = rand(16,1);
tmp = dat;
levels = 4;
C = java.util.Vector;
S = zeros([levels+2 1]);
S(end) = size(tmp,1);
counter = levels+1;
for ii = 1:levels
  L =  downsample(conv(tmp,lpd,'same'),2);
  H =  downsample(conv(tmp,hpd,'same'),2);
  for mm=1:length(H)
    C.addElement(H(mm));
  end
  tmp = L;
  S(counter) = length(L);
  if(ii==levels)
      for mm = 1:numel(L)
          C.addElement(L(mm));
          S(counter-1) = numel(L);
      end 
  end     
    counter = counter-1;
end

CC = zeros([1 C.size()]);
java.util.Collections.reverse(C);
for tt = 0:C.size()-1
    CC(tt+1) =  C.elementAt(tt);
end
disp(['sum(dat.^2) :' num2str(sum(dat.^2))]);
disp(['sum(CC.^2)  :' num2str(sum(CC.^2))]);
